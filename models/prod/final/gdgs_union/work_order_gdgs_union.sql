{{ config(
  materialized='table',
  tags=["final","final_gdgs_union", "gdgs"]
) }}

SELECT 
    uid,
    mobile_verified,
    silt_to_be_excavated_as_per_plan,
    total_silt_required,
    total_silt_excavated,
    farmer_contribution_per_trolley,
    number_of_trolleys_required,
    number_of_hywas_required,
    subject_voided,
    first_name,
    dam,
    district,
    state,
    taluka,
    village,
    type_of_machine,
    category_of_farmer,
    mobile_number,
    name_of_wb,
    ngo_name,
    eid,
    subject_id,
    subject_type,
    encounter_location,
    encounter_type,
    machine_sub_id,
    distance_from_waterbody,
    type_of_land_silt_is_spread_on,
    total_farm_area_silt_is_spread_on,
    farmer_sub_id,
    working_hours_as_per_time,
    total_working_hours_of_machine_by_time,
    total_working_hours_of_machine,
    silt_excavated_as_per_mb_recording,
    total_silt_excavated_encounter,
    date_time,
    total_silt_carted,
    silt_carted_by_farmer_trolleys,
    area_covered_by_silt,
    number_of_trolleys_carted,
    subject_uid
FROM {{ ref('work_order_2024') }}

UNION ALL

SELECT 
    uid,
    mobile_verified,
    silt_to_be_excavated_as_per_plan,
    total_silt_required,
    total_silt_excavated,
    farmer_contribution_per_trolley,
    number_of_trolleys_required,
    number_of_hywas_required,
    subject_voided,
    first_name,
    dam,
    district,
    state,
    taluka,
    village,
    type_of_machine,
    category_of_farmer,
    mobile_number,
    name_of_wb,
    ngo_name,
    eid,
    subject_id,
    subject_type,
    encounter_location,
    encounter_type,
    machine_sub_id,
    distance_from_waterbody,
    type_of_land_silt_is_spread_on,
    total_farm_area_silt_is_spread_on,
    farmer_sub_id,
    working_hours_as_per_time,
    total_working_hours_of_machine_by_time,
    total_working_hours_of_machine,
    silt_excavated_as_per_mb_recording,
    total_silt_excavated_encounter,
    date_time,
    total_silt_carted,
    silt_carted_by_farmer_trolleys,
    area_covered_by_silt,
    number_of_trolleys_carted,
    subject_uid
FROM {{ ref('work_order_gdgs_2023') }}

UNION ALL

SELECT 
    uid,
    mobile_verified,
    silt_to_be_excavated_as_per_plan,
    total_silt_required,
    total_silt_excavated,
    farmer_contribution_per_trolley,
    number_of_trolleys_required,
    number_of_hywas_required,
    subject_voided,
    first_name,
    dam,
    district,
    state,
    taluka,
    village,
    type_of_machine,
    category_of_farmer,
    mobile_number,
    name_of_wb,
    ngo_name,
    eid,
    subject_id,
    subject_type,
    encounter_location,
    encounter_type,
    machine_sub_id,
    distance_from_waterbody,
    type_of_land_silt_is_spread_on,
    total_farm_area_silt_is_spread_on,
    farmer_sub_id,
    working_hours_as_per_time,
    total_working_hours_of_machine_by_time,
    total_working_hours_of_machine,
    silt_excavated_as_per_mb_recording,
    total_silt_excavated_encounter,
    date_time,
    total_silt_carted,
    silt_carted_by_farmer_trolleys,
    area_covered_by_silt,
    number_of_trolleys_carted,
    subject_uid
FROM {{ ref('work_order_2025') }}
